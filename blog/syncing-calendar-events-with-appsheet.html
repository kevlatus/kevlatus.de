<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><title>Syncing calendar events with AppSheet</title><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="icon" href="/assets/images/ic-kevlatus-circle-48.png"/><link rel="apple-touch-icon" sizes="48x48" href="/assets/images/ic-kevlatus-circle-48.png"/><link rel="apple-touch-icon" sizes="72x72" href="/assets/images/ic-kevlatus-circle-72.png"/><link rel="apple-touch-icon" sizes="96x96" href="/assets/images/ic-kevlatus-circle-96.png"/><link rel="apple-touch-icon" sizes="144x144" href="/assets/images/ic-kevlatus-circle-144.png"/><link rel="apple-touch-icon" sizes="192x192" href="/assets/images/ic-kevlatus-circle-192.png"/><link rel="apple-touch-icon" sizes="256x256" href="/assets/images/ic-kevlatus-circle-256.png"/><link rel="apple-touch-icon" sizes="384x384" href="/assets/images/ic-kevlatus-circle-384.png"/><link rel="apple-touch-icon" sizes="512x512" href="/assets/images/ic-kevlatus-circle-512.png"/><meta name="theme-color" content="#3786E9"/><meta property="author" content="Kevin Latusinski"/><meta name="description" content="Building an app without writing code, can be a refreshing ex..."/><meta property="og:description" content="Building an app without writing code, can be a refreshing ex..."/><meta property="og:url" content="https://www.kevlatus.de/blog/syncing-calendar-events-with-appsheet"/><meta property="og:title" content="Syncing calendar events with AppSheet"/><meta property="og:type" content="article"/><meta name="twitter:card" content="summary"/><meta name="twitter:creator" content="@kevlatus"/><meta name="twitter:title" content="Syncing calendar events with AppSheet"/><meta name="twitter:description" content="Building an app without writing code, can be a refreshing ex..."/><meta name="twitter:url" content="https://www.kevlatus.de/blog/syncing-calendar-events-with-appsheet"/><meta property="twitter:image" content="https://raw.githubusercontent.com/kevlatus/kevlatus.de/main/public/assets/images/ic-kevlatus-circle-512.png"/><link rel="preload" href="https://use.typekit.net/xhs5wzt.css" as="style"/><link rel="stylesheet" href="https://use.typekit.net/xhs5wzt.css"/><meta name="next-head-count" content="29"/><link rel="preload" href="/_next/static/css/f8c2e28816ceaf289993.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f8c2e28816ceaf289993.css" data-n-g=""/><link rel="preload" href="/_next/static/css/8d63a2e4a24070d2bde7.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8d63a2e4a24070d2bde7.css" data-n-p=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-2655500d03e7dd101362.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-479699f5e696a59405f8.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.f783f7e0d786735fc5cd.js" as="script"/><link rel="preload" href="/_next/static/chunks/682c571a523b1f552da445b2e05c927df41dc84e.1f52a3ec41a5d5095e70.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-623667d0993bd0c20074.js" as="script"/><link rel="preload" href="/_next/static/chunks/d09f71c2771447e62661a7b2e7969c57ce47c1dd.ad1af2db6fc57853b772.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5Bslug%5D-1aca61b91d753b9bfa16.js" as="script"/></head><body><script>var q=window.matchMedia('(prefers-color-scheme: dark)');function c(e){document.body.className=e.matches?'dark':'light'};q.addEventListener('change',c);c(q)</script><div id="__next"><div class="min-h-full flex flex-col bg-primary-o2"><header class="px-6 py-2 flex items-center"><a href="/"><svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000" class="text-primary fill-current w-6 h-6"><defs><linearGradient id="ic-kevlatus_svg__a" x1="326.17" y1="699.84" x2="900" y2="699.84" gradientUnits="userSpaceOnUse"><stop offset="0" stop-opacity="0.4"></stop><stop offset="1" stop-opacity="0"></stop></linearGradient></defs><path d="M100 836.13V163.87c0-33.48 25.81-61.73 59.24-63.75a63.16 63.16 0 0167.08 63v673.72a63.16 63.16 0 01-67.08 63c-33.43-1.98-59.24-30.23-59.24-63.71zM331.4 563.13a63.13 63.13 0 01-7.86-125.75 614.42 614.42 0 00229.08-76.33c119.23-68.22 190.45-162.35 229.19-229.31A63.12 63.12 0 11891.08 195C844.56 275.36 759 388.44 615.31 470.63a740.07 740.07 0 01-275.89 92 64.22 64.22 0 01-8.02.5z"></path><path d="M836.93 899.78a63.11 63.11 0 01-54.7-31.52C743.49 801.3 672.27 707.17 553 639a614.42 614.42 0 00-229-76.38 63.12 63.12 0 0115.88-125.24 740.07 740.07 0 01275.89 92C759.37 611.56 845 724.64 891.5 805a63.14 63.14 0 01-54.57 94.75z"></path><path d="M868.48 891.28a63.09 63.09 0 01-86.25-23C743.49 801.3 672.27 707.17 553 639a614.14 614.14 0 00-226.87-76c1.73.15 3.47.22 5.23.22a64.22 64.22 0 008-.51 742.24 742.24 0 00219.2-62.72q29.1 13.44 57.11 29.47C759.37 611.56 845 724.64 891.5 805a63.13 63.13 0 01-23.02 86.28z" fill="url(#ic-kevlatus_svg__a)"></path></svg></a><div class="flex-grow"></div><nav class="flex space-x-4"><a class="NavLink_link__GxAtT" href="/"><svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 54" class="NavLink_brush__2Hxlw"><path d="M16 40c7.29 2.25 16.18-.69 23.54 1.36 8.82 2.72 18.38 2.72 27.2 2.72 0-1.36-.73-3.4 0-4.08 2.94-2 2.94-4.77 2.94-7.5 0-1.36-2.2 0-1.47-1.36-2.2 0-5.88-.68-3.67-2 .73-1.36 3.67 0 4.41-2s-.74-4.09 0-6.13h2.94c.73-1.37-.74-4.09 0-4.09 2.2-1.36 5.15-.68 8.09-.68 0-1.36.73-2.72-.74-3.41C53.49 11.36 27 8.64 1.28 10.68c-2.94.68-.74 3.41 1.47 5.45-.74-.68-.74 1.36-1.47.68 0 2 1.47 5.45 4.41 6.13H3.48c-.73.68 0 2 0 3.4.74 0 1.47 0 1.47.69v2.72H2c.74 0 1.47 0 1.47.68v2.73c1.47.68 3.68-.69 5.15 0v2c-1.47.68-3.68 0-5.15 0 .74.68.74 1.36.74 2.72 2.2.68 4.41-1.36 6.62.68h-2.2C10.1 42 13.78 39.28 16 40z"></path></svg><div class="type-display text-xl">Home</div></a><a class="NavLink_link__GxAtT NavLink_active__189zX" href="/blog"><svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 54" class="NavLink_brush__2Hxlw"><path d="M16 40c7.29 2.25 16.18-.69 23.54 1.36 8.82 2.72 18.38 2.72 27.2 2.72 0-1.36-.73-3.4 0-4.08 2.94-2 2.94-4.77 2.94-7.5 0-1.36-2.2 0-1.47-1.36-2.2 0-5.88-.68-3.67-2 .73-1.36 3.67 0 4.41-2s-.74-4.09 0-6.13h2.94c.73-1.37-.74-4.09 0-4.09 2.2-1.36 5.15-.68 8.09-.68 0-1.36.73-2.72-.74-3.41C53.49 11.36 27 8.64 1.28 10.68c-2.94.68-.74 3.41 1.47 5.45-.74-.68-.74 1.36-1.47.68 0 2 1.47 5.45 4.41 6.13H3.48c-.73.68 0 2 0 3.4.74 0 1.47 0 1.47.69v2.72H2c.74 0 1.47 0 1.47.68v2.73c1.47.68 3.68-.69 5.15 0v2c-1.47.68-3.68 0-5.15 0 .74.68.74 1.36.74 2.72 2.2.68 4.41-1.36 6.62.68h-2.2C10.1 42 13.78 39.28 16 40z"></path></svg><div class="type-display text-xl">Blog</div></a></nav><div class="flex-grow"></div><div class="w-6 h-6"></div></header><main class="flex-grow px-2 py-4"><article class="prose prose-sm sm:prose lg:prose-lg xl:prose-2xl mx-auto ArticlePage_article__914Fb"><h2 class="ArticlePage_heading__133R1">Syncing calendar events with AppSheet</h2><div class="flex"><div class="text-xs"><span>02<!-- --> <!-- -->February<!-- --> <!-- -->2021</span><span> | </span><span>~<!-- -->4<!-- --> min read</span></div><div class="flex-grow"></div><a class="text-xs" href="https://getpocket.com/edit?url=https%3A%2F%2Fwww.kevlatus.de%2Fblog%2Fsyncing-calendar-events-with-appsheet" target="_blank">Save to Pocket</a></div><p>Building an app without writing code, can be a refreshing exercise to think differently about the development process. <a href="https://www.kevlatus.de/blog/building-a-room-booking-app-without-writing-code">In another article</a>, I described the steps required for developing a room booking app using the no-code platform AppSheet. But booking a room is not complete before the organizer received a confirmation. Therefore, this article explores options of adding events to a user&#x27;s calendar.</p><p>Here is a quick summary of the RoomBooker: It stores sites, buildings and rooms in a Google Spreadsheet and allows users to book available rooms using a basic form. After a booking is added successfully, users expect it to appear in their calendar. Fortunately, AppSheet integrates with Google Calendar to manipulate calendar events. But there is an issue: calendars need to be added at build time, so we cannot interact with a user&#x27;s calendar, since it is only known at runtime. To circumvent this, we need to <a href="https://support.google.com/calendar/answer/37095">create a new calendar</a> specifically for this app. I decided to make this calendar available to public (or restrict it to a domain in a business environment), so anyone is able to see, when a room is booked. The app will sync bookings as meetings to the new calendar and invite the user as an attendee. The added benefit of this approach is, that users are not required to use a Google Calendar, but are free to use any provider as long as it accepts invitations via mail.</p><p>The calendar data can be added like any other data source using the &quot;New Table&quot; button on AppSheet&#x27;s <em>Data</em> section. For the actual event creation, we use actions and workflows from the <em>Behavior</em> menu. First we create an action by performing the following steps:</p><ol><li>navigate to Behavior &gt; Actions</li><li>create a new action and call it &quot;create event for room booking&quot;</li><li>set the affected table to <code>Room Booking</code></li><li>set the action to &quot;Data: add a new row to another table using values from this row&quot;</li><li>select the table containing calendar events as the <code>table to add to</code></li><li>configure the values as shown in the image below</li></ol><p><img src="https://raw.githubusercontent.com/kevlatus/kevlatus.de/main/public/assets/blog/images/img-appsheet-calendar-creation.png" alt=""/></p><p>The title property is set to the formula <code>CONCATENATE(&quot;Room Booking - &quot;, [Room].[Name])</code> to include booking details, but any other value can be used. Above steps leave us with an action that can be manually triggered by users. For the action to be triggered automatically whenever a new room booking is created, AppSheet&#x27;s workflows are the perfect fit. But first, let&#x27;s go back to the action&#x27;s <em>Appearance</em> options and hide it, so it can&#x27;t be triggered manually. Then we create a new workflow:</p><ol><li>navigate to Behavior &gt; Workflow</li><li>create a new workflow and call it &quot;on adding new room booking&quot;</li><li>set the target data to <code>Room Booking</code> and the event to <code>ADDS_ONLY</code></li><li>under <code>run these tasks...</code> choose <code>change data</code></li><li>select our previously created action &quot;create event for room booking&quot;</li></ol><p>With this setup, our goal is already achieved: whenever a user books a room, he or she will receive a calendar invitation for the selected times. Actually, we will dive deeper and update calendar events, when a booking is changed or deleted. The booking ID, which is saved within an events description comes in handy here. Let&#x27;s first delete a booking&#x27;s event:</p><ol><li>navigate to Behavior &gt; Actions</li><li>create a new action and call it &quot;delete event for room booking&quot;</li><li>set the affected table to <code>Room Booking</code></li><li>set the action to &quot;Data: execute an action on a set of rows&quot;</li><li>select the table containing calendar events as the <code>referenced table</code></li><li>insert the formula below into <code>Referenced Rows</code> and set the action to &quot;Delete&quot;</li></ol><pre style="display:block;overflow-x:auto;padding:1em;background:var(--color-background);color:var(--color-text)"><code class="language-javascript">FILTER(
  &quot;Booking Event&quot;,
  [Description] = [_THISROW].[ID]
)</code></pre><p>To apply changes to a booking, we could propagate them to the calendar event by copying them in an action. Alternatively, we leverage the existing actions within a workflow to first delete the existing event and then create a new one with updated information.</p><p>Bonus Tip: if you want to create all day events from AppSheet, the end date needs to be one day apart from its start. This can be achieved by simply using the formula <code>[Start] + 1</code> for an end date.</p><div class="flex"><div class="flex-grow"></div><a target="_blank" href="https://twitter.com/search?q=https%3A%2F%2Fwww.kevlatus.de%2Fblog%2Fsyncing-calendar-events-with-appsheet">Join the discussion</a><div class="flex-grow"></div></div></article></main><footer class="px-8 py-2 flex items-center justify-center"><ul class="flex space-x-4"><li><a class="group flex flex-col justify-center items-center relative" href="https://github.com/kevlatus"><div class="flex type-display text-xl hidden md:flex"><div class="transition" style="transform:translateY(0) rotate(0)">G</div><div class="transition" style="transform:translateY(0) rotate(0)">i</div><div class="transition" style="transform:translateY(0) rotate(0)">t</div><div class="transition" style="transform:translateY(0) rotate(0)">h</div><div class="transition" style="transform:translateY(0) rotate(0)">u</div><div class="transition" style="transform:translateY(0) rotate(0)">b</div></div><div class="type-display text-xl md:hidden">Github</div><div class="absolute hidden md:flex items-center transform scale-0 transition-transform group-hover:scale-100"><svg viewBox="0 0 1024 1024" fill="none" class="fill-current w-6 h-6"><path clip-rule="evenodd" d="M512 0C229.12 0 0 229.12 0 512c0 226.56 146.56 417.92 350.08 485.76 25.6 4.48 35.2-10.88 35.2-24.32 0-12.16-.64-52.48-.64-95.36-128.64 23.68-161.92-31.36-172.16-60.16-5.76-14.72-30.72-60.16-52.48-72.32-17.92-9.6-43.52-33.28-.64-33.92 40.32-.64 69.12 37.12 78.72 52.48 46.08 77.44 119.68 55.68 149.12 42.24 4.48-33.28 17.92-55.68 32.64-68.48-113.92-12.8-232.96-56.96-232.96-252.8 0-55.68 19.84-101.76 52.48-137.6-5.12-12.8-23.04-65.28 5.12-135.68 0 0 42.88-13.44 140.8 52.48 40.96-11.52 84.48-17.28 128-17.28 43.52 0 87.04 5.76 128 17.28 97.92-66.56 140.8-52.48 140.8-52.48 28.16 70.4 10.24 122.88 5.12 135.68 32.64 35.84 52.48 81.28 52.48 137.6 0 196.48-119.68 240-233.6 252.8 18.56 16 34.56 46.72 34.56 94.72 0 68.48-.64 123.52-.64 140.8 0 13.44 9.6 29.44 35.2 24.32C877.44 929.92 1024 737.92 1024 512 1024 229.12 794.88 0 512 0z"></path></svg></div></a></li><li><a class="group flex flex-col justify-center items-center relative" href="https://linkedin.com/in/kevlatus"><div class="flex type-display text-xl hidden md:flex"><div class="transition" style="transform:translateY(0) rotate(0)">L</div><div class="transition" style="transform:translateY(0) rotate(0)">i</div><div class="transition" style="transform:translateY(0) rotate(0)">n</div><div class="transition" style="transform:translateY(0) rotate(0)">k</div><div class="transition" style="transform:translateY(0) rotate(0)">e</div><div class="transition" style="transform:translateY(0) rotate(0)">d</div><div class="transition" style="transform:translateY(0) rotate(0)">I</div><div class="transition" style="transform:translateY(0) rotate(0)">n</div></div><div class="type-display text-xl md:hidden">LinkedIn</div><div class="absolute hidden md:flex items-center transform scale-0 transition-transform group-hover:scale-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current w-6 h-6"><path d="M19 0H5a5 5 0 00-5 5v14a5 5 0 005 5h14a5 5 0 005-5V5a5 5 0 00-5-5zM8 19H5V8h3v11zM6.5 6.732c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zM20 19h-3v-5.604c0-3.368-4-3.113-4 0V19h-3V8h3v1.765c1.396-2.586 7-2.777 7 2.476V19z"></path></svg></div></a></li><li><a class="group flex flex-col justify-center items-center relative" href="https://twitter.com/kevlatus"><div class="flex type-display text-xl hidden md:flex"><div class="transition" style="transform:translateY(0) rotate(0)">T</div><div class="transition" style="transform:translateY(0) rotate(0)">w</div><div class="transition" style="transform:translateY(0) rotate(0)">i</div><div class="transition" style="transform:translateY(0) rotate(0)">t</div><div class="transition" style="transform:translateY(0) rotate(0)">t</div><div class="transition" style="transform:translateY(0) rotate(0)">e</div><div class="transition" style="transform:translateY(0) rotate(0)">r</div></div><div class="type-display text-xl md:hidden">Twitter</div><div class="absolute hidden md:flex items-center transform scale-0 transition-transform group-hover:scale-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current w-6 h-6"><path d="M24 4.557a9.83 9.83 0 01-2.828.775 4.932 4.932 0 002.165-2.724 9.864 9.864 0 01-3.127 1.195 4.916 4.916 0 00-3.594-1.555c-3.179 0-5.515 2.966-4.797 6.045A13.978 13.978 0 011.671 3.149a4.93 4.93 0 001.523 6.574 4.903 4.903 0 01-2.229-.616c-.054 2.281 1.581 4.415 3.949 4.89a4.935 4.935 0 01-2.224.084 4.928 4.928 0 004.6 3.419A9.9 9.9 0 010 19.54a13.94 13.94 0 007.548 2.212c9.142 0 14.307-7.721 13.995-14.646A10.025 10.025 0 0024 4.557z"></path></svg></div></a></li></ul></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"content":"Building an app without writing code, can be a refreshing exercise to think differently about the development process. [In another article](https://www.kevlatus.de/blog/building-a-room-booking-app-without-writing-code), I described the steps required for developing a room booking app using the no-code platform AppSheet. But booking a room is not complete before the organizer received a confirmation. Therefore, this article explores options of adding events to a user's calendar.\n\nHere is a quick summary of the RoomBooker: It stores sites, buildings and rooms in a Google Spreadsheet and allows users to book available rooms using a basic form. After a booking is added successfully, users expect it to appear in their calendar. Fortunately, AppSheet integrates with Google Calendar to manipulate calendar events. But there is an issue: calendars need to be added at build time, so we cannot interact with a user's calendar, since it is only known at runtime. To circumvent this, we need to [create a new calendar](https://support.google.com/calendar/answer/37095) specifically for this app. I decided to make this calendar available to public (or restrict it to a domain in a business environment), so anyone is able to see, when a room is booked. The app will sync bookings as meetings to the new calendar and invite the user as an attendee. The added benefit of this approach is, that users are not required to use a Google Calendar, but are free to use any provider as long as it accepts invitations via mail.\n\nThe calendar data can be added like any other data source using the \"New Table\" button on AppSheet's _Data_ section. For the actual event creation, we use actions and workflows from the _Behavior_ menu. First we create an action by performing the following steps:\n\n1. navigate to Behavior \u003e Actions\n1. create a new action and call it \"create event for room booking\"\n1. set the affected table to `Room Booking`\n1. set the action to \"Data: add a new row to another table using values from this row\"\n1. select the table containing calendar events as the `table to add to`\n1. configure the values as shown in the image below\n\n![](https://raw.githubusercontent.com/kevlatus/kevlatus.de/main/public/assets/blog/images/img-appsheet-calendar-creation.png)\n\nThe title property is set to the formula `CONCATENATE(\"Room Booking - \", [Room].[Name])` to include booking details, but any other value can be used. Above steps leave us with an action that can be manually triggered by users. For the action to be triggered automatically whenever a new room booking is created, AppSheet's workflows are the perfect fit. But first, let's go back to the action's _Appearance_ options and hide it, so it can't be triggered manually. Then we create a new workflow:\n\n1. navigate to Behavior \u003e Workflow\n1. create a new workflow and call it \"on adding new room booking\"\n1. set the target data to `Room Booking` and the event to `ADDS_ONLY`\n1. under `run these tasks...` choose `change data`\n1. select our previously created action \"create event for room booking\"\n\nWith this setup, our goal is already achieved: whenever a user books a room, he or she will receive a calendar invitation for the selected times. Actually, we will dive deeper and update calendar events, when a booking is changed or deleted. The booking ID, which is saved within an events description comes in handy here. Let's first delete a booking's event:\n\n1. navigate to Behavior \u003e Actions\n1. create a new action and call it \"delete event for room booking\"\n1. set the affected table to `Room Booking`\n1. set the action to \"Data: execute an action on a set of rows\"\n1. select the table containing calendar events as the `referenced table`\n1. insert the formula below into `Referenced Rows` and set the action to \"Delete\"\n\n```javascript\nFILTER(\n  \"Booking Event\",\n  [Description] = [_THISROW].[ID]\n)\n```\n\nTo apply changes to a booking, we could propagate them to the calendar event by copying them in an action. Alternatively, we leverage the existing actions within a workflow to first delete the existing event and then create a new one with updated information.\n\nBonus Tip: if you want to create all day events from AppSheet, the end date needs to be one day apart from its start. This can be achieved by simply using the formula `[Start] + 1` for an end date.\n","slug":"syncing-calendar-events-with-appsheet","timestamp":"2021-02-02","title":"Syncing calendar events with AppSheet","status":"2 final","description":"Building an app without writing code, can be a refreshing ex..."}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"syncing-calendar-events-with-appsheet"},"buildId":"5m45zT26t2FgPfCxoFkzQ","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-51ce6eb9ed73aacaf515.js"></script><script src="/_next/static/chunks/main-2655500d03e7dd101362.js" async=""></script><script src="/_next/static/chunks/webpack-479699f5e696a59405f8.js" async=""></script><script src="/_next/static/chunks/framework.f783f7e0d786735fc5cd.js" async=""></script><script src="/_next/static/chunks/682c571a523b1f552da445b2e05c927df41dc84e.1f52a3ec41a5d5095e70.js" async=""></script><script src="/_next/static/chunks/pages/_app-623667d0993bd0c20074.js" async=""></script><script src="/_next/static/chunks/d09f71c2771447e62661a7b2e7969c57ce47c1dd.ad1af2db6fc57853b772.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-1aca61b91d753b9bfa16.js" async=""></script><script src="/_next/static/5m45zT26t2FgPfCxoFkzQ/_buildManifest.js" async=""></script><script src="/_next/static/5m45zT26t2FgPfCxoFkzQ/_ssgManifest.js" async=""></script></body></html>